<html>

</html>

<head>
    <link rel="icon" type="image/png" href="/favicon.png">

    <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
    <script async
        src="https://cdn.jsdelivr.net/gh/iammacheta/prebid-code@e50b7b6e7acfcb891dbc88b8b21caaa95b5298d2/prebid.js"></script>
    <!-- <script async src="https://storage.cloud.google.com/cdn.mobalytics.gg/assets/common/prebid/prebid.js"></script> -->

    <script>
        var div_display_m_sizes = [
            [300, 250],
            [336, 280],
            [338, 280],
            [300, 50],
            [320, 100],
            [300, 100],
            [250, 250],
            [200, 200],
        ];
        var div_display_l_sizes = [
            [300, 250],
            [336, 280],
            [338, 280],
            [120, 240],
            [320, 50],
            [320, 100],
            [300, 50],
            [300, 100],
            [250, 360],
            [250, 250],
            [200, 200],
            [320, 480],
            [240, 400],
            [160, 600],
            [300, 600],
            [120, 600],
        ];
        var div_display_footer_d_sizes = [
            [728, 90],
            [970, 90],
            [750, 100],
            [980, 120],
        ];
        var div_display_footer_m_sizes = [
            [320, 50],
            [320, 100],
            [300, 50],
            [300, 100],
            [468, 60],
        ];

        var PREBID_TIMEOUT = 2000;
        var FAILSAFE_TIMEOUT = 3000;
        var REFRESH_INTERVAL = 30000;

        var adUnits = [
            {
                code: '/21974715207/web-destiny-2-display-m',
                mediaTypes: {
                    banner: {
                        sizes: div_display_m_sizes
                    }
                },
                bids: [
                    {
                        bidder: 'pubmatic',
                        params: {
                            publisherId: '165261',
                            adSlot: '6141440'
                        }
                    },
                    {
                        bidder: 'appnexus',
                        params: {
                            placementId: 34122281,
                            allowSmallerSizes: true,
                            position: 'above'
                        }
                    },
                    {
                        bidder: "adagio",
                        params: {
                            organizationId: "1458",
                            site: "mobalytics-gg",
                        }
                    },
                    {
                        bidder: 'oms',
                        params: {
                            publisherId: '21048',
                        }
                    },
                    {
                        bidder: 'sovrn',
                        params: {
                            tagid: '1256209'
                        }
                    }],
                // Params shared between all bidders
                ortb2Imp: {
                    ext: {
                        data: {
                            divId: "web-destiny-2-display-m",
                            placement: "sidebar-1",
                        }
                    }
                }
            },
            {
                code: '/21974715207/web-destiny-2-display-l',
                mediaTypes: {
                    banner: {
                        sizes: div_display_l_sizes
                    }
                },
                bids: [
                    {
                        bidder: 'pubmatic',
                        params: {
                            publisherId: '165261',
                            adSlot: '6141441'
                        }
                    },
                    {
                        bidder: 'appnexus',
                        params: {
                            placementId: 34122285,
                            allowSmallerSizes: true,
                        }
                    },
                    {
                        bidder: "adagio",
                        params: {
                            organizationId: "1458",
                            site: "mobalytics-gg",
                        }
                    },
                    {
                        bidder: 'oms',
                        params: {
                            publisherId: '21048',
                        }
                    },
                    {
                        bidder: 'sovrn',
                        params: {
                            tagid: '1256210'
                        }
                    }],
                // Params shared between all bidders
                ortb2Imp: {
                    ext: {
                        data: {
                            divId: "web-destiny-2-display-l",
                            placement: "sidebar-2",
                        }
                    }
                }
            },
            {
                code: '/21974715207/web-destiny-2-display-footer-d',
                mediaTypes: {
                    banner: {
                        sizes: div_display_footer_d_sizes
                    }
                },
                bids: [
                    {
                        bidder: 'pubmatic',
                        params: {
                            publisherId: '165261',
                            adSlot: '6141442'
                        }
                    },
                    {
                        bidder: 'appnexus',
                        params: {
                            placementId: 34122289,
                            position: 'above'
                        }
                    },
                    {
                        bidder: "adagio",
                        params: {
                            organizationId: "1458",
                            site: "mobalytics-gg",
                        }
                    },
                    {
                        bidder: 'oms',
                        params: {
                            publisherId: '21048',
                        }
                    },
                    {
                        bidder: 'sovrn',
                        params: {
                            tagid: '1256211'
                        }
                    }],
                // Params shared between all bidders
                ortb2Imp: {
                    ext: {
                        data: {
                            divId: "web-destiny-2-display-footer-d",
                            placement: "footer-w",
                        }
                    }
                }
            },
            {
                code: '/21974715207/web-destiny-2-display-footer-m',
                mediaTypes: {
                    banner: {
                        sizes: div_display_footer_m_sizes
                    }
                },
                bids: [
                    {
                        bidder: 'pubmatic',
                        params: {
                            publisherId: '165261',
                            adSlot: '6141443'
                        }
                    },
                    {
                        bidder: 'appnexus',
                        params: {
                            placementId: 34122291,
                            allowSmallerSizes: true,
                            position: 'above'
                        }
                    },
                    {
                        bidder: "adagio",
                        params: {
                            organizationId: "1458",
                            site: "mobalytics-gg",
                        }
                    },
                    {
                        bidder: 'oms',
                        params: {
                            publisherId: '21048',
                        }
                    },
                    {
                        bidder: 'sovrn',
                        params: {
                            tagid: '1256212'
                        }
                    }],
                // Params shared between all bidders
                ortb2Imp: {
                    ext: {
                        data: {
                            divId: "web-destiny-2-display-footer-m",
                            placement: "footer-s",
                        }
                    }
                }
            },
        ];

        const customConfigObject = {
            "buckets": [
                {
                    "max": 3,
                    "increment": 0.01
                },
                {
                    "max": 5,
                    "increment": 0.05
                },
                {
                    "max": 9,
                    "increment": 0.1
                },
                {
                    "max": 40,
                    "increment": 0.5
                },
                {
                    "max": 100,
                    "increment": 10.00
                }
            ]
        };

        // ======== DO NOT EDIT BELOW THIS LINE =========== //
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
        googletag.cmd.push(function () {
            googletag.pubads().disableInitialLoad();
        });

        var pbjs = pbjs || {};
        pbjs.que = pbjs.que || [];

        pbjs.que.push(function () {
            pbjs.onEvent('auctionDebug', function (eventData) {
                if (
                    eventData &&
                    eventData.type === 'ERROR' &&
                    eventData.arguments &&
                    eventData.arguments[0] === 'TCF2 CMP not found. Canceling auction as per consentManagement config.'
                ) {
                    console.log("CMP NOT FOUND ERROR OCCURED. SENDING EVENT TO MIXPANEL ||||||||||||||||||||||||||||||||")
                }
            });
        });

        pbjs.que.push(function () {
            pbjs.bidderSettings = {
                standard: {
                    storageAllowed: false
                },
                appnexus: {
                    storageAllowed: true
                },
                pubmatic: {
                    storageAllowed: true
                },
                openx: {
                    storageAllowed: true
                },
                ix: {
                    storageAllowed: true
                },
                rubicon: {
                    storageAllowed: true
                },
                sovrn: {
                    storageAllowed: true
                },
                smartadserver: {
                    storageAllowed: true
                },
                criteo: {
                    storageAllowed: true
                },
                ogury: {
                    storageAllowed: true
                },
                adagio: {
                    storageAllowed: true
                }
            }

            pbjs.setConfig({
                enableSendAllBids: false,
                enableTIDs: true,
                priceGranularity: customConfigObject,
                consentManagement: {
                    "gdpr": {
                        "cmpApi": "iab",
                        "timeout": 500,
                        "actionTimeout": 10000,
                        "defaultGdprScope": false,
                        "allowAuctionWithoutConsent": true
                    },
                    usp: {
                        cmpApi: 'iab',
                        timeout: 500,
                    }
                },
                gptPreAuction: {
                    enabled: true,
                },
                currency: {
                    adServerCurrency: 'USD',
                    granularityMultiplier: 1,
                    defaultRates: {
                        'EUR': 1.10,
                        'GBP': 1.30
                    },
                    conversionRateFile: 'https://cdn.jsdelivr.net/gh/prebid/currency-file@1/latest.json',
                },
                deviceAccess: true,
                userSync: {
                    filterSettings: {
                        iframe: {
                            bidders: ['pubmatic', 'appnexus', 'openx', 'ix', 'rubicon', 'sovrn', 'smartadserver', 'criteo', 'ogury', 'adagio'],
                            filter: 'include'
                        }
                    }
                }
            });
            pbjs.addAdUnits(adUnits);
            pbjs.requestBids({
                bidsBackHandler: initAdserver,
                timeout: PREBID_TIMEOUT
            });
        });

        function initAdserver() {
            if (pbjs.initAdserverSet) return;
            pbjs.initAdserverSet = true;
            googletag.cmd.push(function () {
                pbjs.que.push(function () {
                    pbjs.setTargetingForGPTAsync();
                    googletag.pubads().refresh();
                });
            });
        }

        function refreshBid() {
            pbjs.que.push(function () {
                pbjs.requestBids({
                    timeout: PREBID_TIMEOUT,
                    adUnitCodes: ['/21974715207/web-destiny-2-display-m', '/21974715207/web-destiny-2-display-l', '/21974715207/web-destiny-2-display-footer-d', '/21974715207/web-destiny-2-display-footer-m'],
                    bidsBackHandler: function () {
                        pbjs.setTargetingForGPTAsync(['/21974715207/web-destiny-2-display-m', '/21974715207/web-destiny-2-display-l', '/21974715207/web-destiny-2-display-footer-d', '/21974715207/web-destiny-2-display-footer-m']);
                        googletag.pubads().refresh();
                    }
                });
            });
        }

        setTimeout(function () {
            initAdserver();
        }, FAILSAFE_TIMEOUT);

        // ====================================== //

        googletag.cmd.push(function () {
            const adSlots = [
                { path: '/21974715207/web-destiny-2-display-m', sizes: div_display_m_sizes, id: 'div_display_m' },
                { path: '/21974715207/web-destiny-2-display-l', sizes: div_display_l_sizes, id: 'div_display_l' },
                { path: '/21974715207/web-destiny-2-display-footer-d', sizes: div_display_footer_d_sizes, id: 'div_display_footer_d' },
                { path: '/21974715207/web-destiny-2-display-footer-m', sizes: div_display_footer_m_sizes, id: 'div_display_footer_m' }
            ];

            adSlots.forEach(slot => {
                googletag.defineSlot(slot.path, slot.sizes, slot.id).addService(googletag.pubads());
            });

            googletag.pubads().enableSingleRequest();

            googletag.pubads().addEventListener('impressionViewable', function (event) {
                var slot = event.slot;
                if (slot.getSlotElementId() === "div_display_m") {
                    setTimeout(function () {
                        refreshBid()
                    }, REFRESH_INTERVAL);
                }
            });

            googletag.enableServices();
        });

    </script>
</head>

<body>
    <h2>Basic Prebid.js Example</h2>
    <h5>Div display_m</h5>
    <div id='div_display_m' style='width: 336px; height: 280px;'>
        <script type='text/javascript'>
            googletag.cmd.push(function () {
                googletag.pubads().collapseEmptyDivs();
                googletag.display('div_display_m');
            });
        </script>
    </div>

    <br>

    <h5>Div display_l</h5>
    <div id='div_display_l' style='width: 300px; height: 600px;'>
        <script type='text/javascript'>
            googletag.cmd.push(function () {
                googletag.pubads().collapseEmptyDivs();
                googletag.display('div_display_l');
            });
        </script>
    </div>

    <h5>Div display_footer_d</h5>
    <div id='div_display_footer_d' style='width: 728px; height: 90px;'>
        <script type='text/javascript'>
            googletag.cmd.push(function () {
                googletag.pubads().collapseEmptyDivs();
                googletag.display('div_display_footer_d');
            });
        </script>
    </div>

    <h5>Div display_footer_m</h5>
    <div id='div_display_footer_m' style='width: 320px; height: 100px;'>
        <script type='text/javascript'>
            googletag.cmd.push(function () {
                googletag.pubads().collapseEmptyDivs();
                googletag.display('div_display_footer_m');
            });
        </script>
    </div>
</body>

</html>